/*
 * Copyright (c) 2015 by Greg Reimer <gregreimer@gmail.com>
 * All Rights Reserved.
 */

var pony = require('../index')
  , assert = require('assert')

describe('eventual-pony', function(){

  describe('writables', function(){

    it('should create a writable', function(done){

      pony.writable(function* (input) {
        var data = yield input()
        assert.equal(data, 'hello')
        done()
      }).write('hello')
    })
  })

  describe('readables', function(){

    it('should create a readable', function(done){

      pony.readable(function* (output) {
        yield output('hello')
      }).on('data', function(data) {
        assert.equal(data, 'hello')
        done()
      }).on('error', done)
    })
  })

  describe('transforms', function(){

    it('should create a transform', function(done){

      var tr = pony.transform(function* (input, output) {
        yield output(yield input())
      })
      tr.on('data', function(data) {
        assert.equal(data, 'hello')
        done()
      }).on('error', done)
      tr.write('hello')
    })
  })
})

