# Eventual Pony

Process streams with generators.

 * Write async stream logic in sync style.
 * Readables, writables or transforms in one interface.
 * Streams implement streams2 and can `pipe()`, etc.
 * Exerts and adapts to backpressure.
 * Throw in your generator to emit 'error' on the stream.
 * Backed by [co](https://www.npmjs.com/package/co) so do co stuff in your generator.
 * Awesome name.

--------------------

## API

```js
var pony = require('eventual-pony')

// create a stream
var stream = pony([opts], function* (input, output) {
  // handle yo bizness
})

up.pipe(stream).pipe(down)
```

 * **opts** - Options object passed to native stream constructor. (optional)
 * **input()** - Returns promise for next available upstream value.
 * **input.ended()** - Whether input is ended. Useful as a test in a while loop.
 * **output(chunk)** - Sends a value downstream. Returns a promise that resolves more or less quickly depending on how fast downstream is accepting data.

--------------------

## Examples

### Readable: fibonacci numbers

```js
pony(function*(in, out){
  var f1 = 1
    , f2 = 1
  while (true) {
    let result = f2
    f2 = f1
    f1 = f1 + result
    yield out(result)
  }
})
```

--------------------

### Writable: Sum a stream of numbers

```js
pony(function*(in, out){
  var sum = 0
  while (!in.ended())
    sum += yield in()
  console.log(sum)
})
```

--------------------

### Transform: String de-duper

```js
pony(function*(in, out){
  var uniq = new Set()
  while (!in.ended()) {
    var chunk = yield in()
    if (!uniq.has(chunk)) {
      uniq.add(chunk)
      yield out(chunk)
    }
  }
})
```
